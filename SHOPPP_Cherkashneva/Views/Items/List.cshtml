@using SHOPPP_Cherkashneva.Data.ViewModell;
@using SHOPPP_Cherkashneva.Data.Models;
@model VMItems

@{
    Layout = "_Layout";
}
<div>
    <select onchange="SelectCategory(this)">
        <option value="0">Выбрать....</option>
        @{
            foreach(Categorys categorys in Model.Categorys)
            {
                if (categorys.Id == Model.SelectCategory)
                {
                        <option value="@categorys.Id" selected="selected">@categorys.Name</option>
                }
                else
                {
                        <option value="@categorys.Id" >@categorys.Name</option>
                }
            }
         }
    </select>
    <script>
        function SelectCategory(sender){
            window.location = "/Items/List?id=" + sender.value;
        }
    </script>
</div>
<h2>Все предметы</h2>
@{
    foreach (var item in Model.Items)
    {
        if(item.Category.Id== Model.SelectCategory)
        {
            <div class="item">
                <img src="@item.Img" />
                <div class="basket">
                    <div class="button" id="@item.Id">
                        В корзину
                    </div>
                    <div class="count">
                        <div class="button min">-</div>
                        <div class="text">1</div>
                        <div class="button max">+</div>
                    </div>
                </div>
                <div class="data">
                    <h3>Модель: @item.Name</h3>
                    <div>Цена: @item.Price</div>
                    <div>Категория: @item.Category.Name</div>
                    <div>Описание: @item.Description</div>
                    <a href="/Items/Update?id=@item.Id">Изменить</a>
                    <form class="delete" method="post" action="/Items/Delete" onsubmit="return confirm('Вы уверен что хотите удалить предмет?');">
                        <input type="hidden" name="id" value="@item.Id" />
                        <input type="submit" value="Удалить" />
                    </form>
                </div>
            </div>
        }
    }
}
<script>
    $(".item").children(".basket").children(".button").click(function(){
        $(this).parent().children(".count").show();
        $(this).hide();
        $.ajax({
            url: '@Url.Action("Basket", "Items")',
            contentType: "application/json; charset=utf-8",
            data: { idItem: $(this).attr('id')},
            dataType: "json",
            success: SuccessBasket,
            error: AjaxError
        });
    });
    function SuccessBasket(data){
        console.log(data);
    }
    function AjaxError(){
        console.log("Ошибка выполнения ajax");
    }
</script>
